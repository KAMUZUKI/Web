"use strict";(self["webpackChunkdormitory"]=self["webpackChunkdormitory"]||[]).push([[541],{2541:function(e,a,t){t.r(a),t.d(a,{default:function(){return W}});var n=t(3396),s=t(7139);const d=e=>((0,n.dD)("data-v-7f652480"),e=e(),(0,n.Cn)(),e),l={class:"table"},o={style:{width:"100%",display:"inline"}},u={key:0},i={key:1,class:"editable-row-operations"},r={key:0},m=d((()=>(0,n._)("a",null,"取消",-1))),p={key:1},c=["onClick"],f={key:2,class:"editable-row-operations"},v=d((()=>(0,n._)("a",null,"删除",-1)));function h(e,a,t,d,h,g){const w=(0,n.up)("a-button"),y=(0,n.up)("a-input"),x=(0,n.up)("a-typography-link"),b=(0,n.up)("a-popconfirm"),S=(0,n.up)("a-table"),k=(0,n.up)("a-form-item"),_=(0,n.up)("a-input-number"),W=(0,n.up)("a-radio"),C=(0,n.up)("a-radio-group"),I=(0,n.up)("a-select"),U=(0,n.up)("a-form"),D=(0,n.up)("a-drawer");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",o,[(0,n.Wm)(w,{style:{float:"left","margin-left":"60px","margin-top":"20px"},type:"primary",onClick:e.showDrawer},{default:(0,n.w5)((()=>[(0,n.Uk)("添加学生")])),_:1},8,["onClick"])]),(0,n.Wm)(S,{style:{"min-width":"1000px"},columns:e.columns,"data-source":e.dataSource,bordered:""},{bodyCell:(0,n.w5)((({column:a,text:t,record:d})=>[["address","phone"].includes(a.dataIndex)?((0,n.wg)(),(0,n.iD)("div",u,[e.editableData[d.sno]?((0,n.wg)(),(0,n.j4)(y,{key:0,value:e.editableData[d.sno][a.dataIndex],"onUpdate:value":t=>e.editableData[d.sno][a.dataIndex]=t,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)((0,s.zw)(t),1)],64))])):"modify"===a.dataIndex?((0,n.wg)(),(0,n.iD)("div",i,[e.editableData[d.sno]?((0,n.wg)(),(0,n.iD)("span",r,[(0,n.Wm)(x,{onClick:a=>e.save(d)},{default:(0,n.w5)((()=>[(0,n.Uk)("保存")])),_:2},1032,["onClick"]),(0,n.Wm)(b,{title:"确认取消?",onConfirm:a=>e.cancel(d.sno)},{default:(0,n.w5)((()=>[m])),_:2},1032,["onConfirm"])])):((0,n.wg)(),(0,n.iD)("span",p,[(0,n._)("a",{onClick:a=>e.edit(d.sno)},"编辑",8,c)]))])):"delete"===a.dataIndex?((0,n.wg)(),(0,n.iD)("div",f,[(0,n._)("span",null,[(0,n.Wm)(b,{title:"确认删除?","ok-text":"删除","cancel-text":"取消",onConfirm:a=>e.deleteById(d.sno)},{default:(0,n.w5)((()=>[v])),_:2},1032,["onConfirm"])])])):(0,n.kq)("",!0)])),_:1},8,["columns","data-source"]),(0,n.Wm)(D,{title:"添加学生",width:300,visible:e.visible,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:e.onClose},{default:(0,n.w5)((()=>[(0,n.Wm)(U,{model:e.formState,name:"nest-messages",onFinish:e.onFinish,onOnFinishFailed:e.onFinishFailed,"validate-messages":e.validateMessages},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{name:["student","sname"],label:"名字",rules:[{required:!0,message:"填写学生名字"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{value:e.formState.student.sname,"onUpdate:value":a[0]||(a[0]=a=>e.formState.student.sname=a)},null,8,["value"])])),_:1}),(0,n.Wm)(k,{name:["student","age"],label:"年龄",rules:[{required:!0,type:"number",min:10,max:30,message:"年龄在10-30之间"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(_,{value:e.formState.student.age,"onUpdate:value":a[1]||(a[1]=a=>e.formState.student.age=a)},null,8,["value"])])),_:1}),(0,n.Wm)(k,{name:["student","sex"],label:"性别",rules:[{required:!0,message:"选择性别"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{value:e.formState.student.sex,"onUpdate:value":a[2]||(a[2]=a=>e.formState.student.sex=a)},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{value:"1"},{default:(0,n.w5)((()=>[(0,n.Uk)("男")])),_:1}),(0,n.Wm)(W,{value:"0"},{default:(0,n.w5)((()=>[(0,n.Uk)("女")])),_:1})])),_:1},8,["value"])])),_:1}),(0,n.Wm)(k,{name:["student","academy"],label:"学院名称",rules:[{required:!0,message:"选择学院"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(I,{showSearch:"",value:e.formState.student.academy,"onUpdate:value":a[3]||(a[3]=a=>e.formState.student.academy=a),smode:"single",style:{width:"100%"},placeholder:"请选择学院",options:e.academys},null,8,["value","options"])])),_:1}),(0,n.Wm)(k,{name:["student","classname"],label:"班级名称",rules:[{required:!0,message:"填写班级名称"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{value:e.formState.student.classname,"onUpdate:value":a[4]||(a[4]=a=>e.formState.student.classname=a)},null,8,["value"])])),_:1}),(0,n.Wm)(k,{name:["student","address"],label:"住宿地址",rules:[{required:!0,message:"填写住宿地址"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{value:e.formState.student.address,"onUpdate:value":a[5]||(a[5]=a=>e.formState.student.address=a)},null,8,["value"])])),_:1}),(0,n.Wm)(k,{name:["student","phone"],label:"手机号",rules:[{required:!0,message:"填写手机号"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{value:e.formState.student.phone,"onUpdate:value":a[6]||(a[6]=a=>e.formState.student.phone=a)},null,8,["value"])])),_:1}),(0,n.Wm)(k,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,{shape:"round",type:"primary","html-type":"submit"},{default:(0,n.w5)((()=>[(0,n.Uk)("提交")])),_:1})])),_:1})])),_:1},8,["model","onFinish","onOnFinishFailed","validate-messages"])])),_:1},8,["visible","onClose"])])}t(7658);var g=t(6468),w=t(4870),y=t(252),x=t(4311),b=t(65),S=(0,n.aZ)({name:"BaseInfo",setup(){const e=(0,b.oR)(),a=(0,w.iH)([]),t=[{title:"学号",width:10,dataIndex:"sno"},{title:"名字",width:10,dataIndex:"sname"},{title:"年龄",dataIndex:"age",width:10},{title:"性别",dataIndex:"sex",width:10},{title:"学院",dataIndex:"academy",width:60},{title:"班级",dataIndex:"classname",width:20},{title:"住址",dataIndex:"address",width:50},{title:"电话",dataIndex:"phone",width:30},{title:"操作",dataIndex:"modify",width:15},{title:"操作",dataIndex:"delete",width:15}],s=(0,w.qj)({student:{sname:"",age:"",sex:"",academy:"",classname:"",address:"",phone:""}}),d={required:"${label} 是必要的!",types:{email:"${label} 是无效的邮箱!",number:"${label} 是无效的数字!"}},l=(0,w.iH)([]),o=(0,w.iH)([]),u=()=>{const t=(0,w.iH)([]);var n=new URLSearchParams;n.append("op","getAllAcademy"),x.Z.post(e.state.path+"/info.action",n).then((e=>{if(1==e.data.code){t.value=e.data.data;for(var n=0;n<t.value.length;n++)a.value.push({index:n,value:t.value[n].aname});sessionStorage.setItem("academys",JSON.stringify(a.value))}else console.log(e.data.msg)})).catch((function(e){console.log(e)}))},i=()=>{var a=new URLSearchParams;a.append("op","getAllStudent"),x.Z.post(e.state.path+"/info.action",a).then((e=>{if(1==e.data.code){o.value=e.data.data;for(const[e,a]of Object.entries(o.value))1==a.sex?a.sex="男":a.sex="女",l.value.push(a);y.ZP.success("获取学生信息成功")}else y.ZP.error("获取学生信息失败")})).catch((function(e){console.log(e)}))},r=(0,w.qj)({}),m=e=>{r[e]=(0,g.Z)(l.value.filter((a=>e===a.sno))[0])},p=e=>{console.log(e)},c=e=>{delete r[e]},f=a=>{var t=new URLSearchParams;t.append("op","deleteStudentBySno"),t.append("sno",a),x.Z.post(e.state.path+"/info.action",t).then((e=>{1==e.data.code?(l.value=l.value.filter((e=>a!==e.sno)),y.ZP.success(e.data.msg)):y.ZP.error(e.data.msg)})).catch((function(e){console.log(e)}))},v=a=>{console.log(a);var t=new URLSearchParams;t.append("op","addStudent"),t.append("sname",s.student.sname),t.append("age",s.student.age),t.append("sex",0!=s.student.sex),t.append("academy",s.student.academy),t.append("classname",s.student.classname),t.append("address",s.student.address),t.append("phone",s.student.phone),x.Z.post(e.state.path+"/info.action",t).then((e=>{1==e.data.code?(l.value.push({sname:s.student.sname,age:s.student.age,sex:s.student.sex,academy:s.student.academy,classname:s.student.classname,address:s.student.address,phone:s.student.phone}),s.student.sname="",s.student.age="",s.student.sex="",s.student.academy="",s.student.classname="",s.student.address="",s.student.phone="",y.ZP.success(e.data.msg)):y.ZP.error(e.data.msg)})).catch((function(e){console.log(e)}))},h=e=>{console.log("Failed:",e)},S={labelCol:{span:6},wrapperCol:{span:16}},k=(0,w.iH)(!1),_=()=>{k.value=!0},W=()=>{k.value=!1};return(0,n.bv)((()=>{i(),u()})),{dataSource:l,columns:t,editingKey:"",editableData:r,layout:S,visible:k,formState:s,validateMessages:d,academys:a,edit:m,save:p,cancel:c,deleteById:f,confirm:confirm,onClose:W,showDrawer:_,onFinish:v,onFinishFailed:h}}}),k=t(89);const _=(0,k.Z)(S,[["render",h],["__scopeId","data-v-7f652480"]]);var W=_}}]);
//# sourceMappingURL=541.b6312aef.js.map